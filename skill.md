# skill.md — Project Knowledge

## What This Project Is

**libs-genclaude** is a curated gallery of 48 web animation demos across 5 categories: scroll animations, 3D/WebGL, View Transitions, CSS/Canvas effects, and full page builds. Each demo is a self-contained example of a specific animation technique, designed to serve as both a visual showcase and a code reference. All code was generated by Claude Opus 4.6.

## Technologies and Their Roles

| Technology | What It Does Here |
|-----------|-------------------|
| **GSAP (GreenSock)** | Powers all scroll-driven animations. ScrollTrigger pins sections and scrubs timelines. SplitText breaks text into animatable units. ScrambleText creates typewriter/glitch effects. FLIP handles layout transition animations. |
| **Lenis** | Provides smooth momentum-based scrolling. Integrated with GSAP's ticker for frame-perfect sync. |
| **Three.js** | Renders all 3D/WebGL demos. Used for particle systems, shader materials, PBR rendering, InstancedMesh, and post-processing (bloom). |
| **View Transitions API** | Native browser API for animating between DOM states. Used for page routing transitions, card-to-detail morphs, theme switching with clip-path wipes, and image gallery crossfades. |
| **Canvas 2D** | Used for bokeh particle effects, grain overlays, bezier blob animation, neural network visualizations, waveform visualizers, and particle physics. |
| **CSS** | Keyframe animations for card entrances, border-radius morphing, mask-image spotlight effects, scanline overlays, CRT effects, and retro pixel aesthetics. |
| **Vite** | Dev server with HMR for complex demos. Multi-page build config auto-discovers bundled demos. |
| **bun** | Package manager (use `bun install`, `bun run dev`, not npm). |

## Two Types of Demos

### Vite-Bundled (38 demos)
- Contain a `.vite-demo` marker file in their directory
- Use ES module `import` statements for npm packages
- Get Vite's HMR, tree-shaking, and module resolution
- Examples: scroll demos (01–06, 36–40), 3D demos (07–10, 21–22), all pages demos (23–35, 41–48)

### Static (10 demos)
- No `.vite-demo` marker — just plain HTML/CSS/JS
- Served as-is by Vite's dev server (no bundling needed)
- Use native browser APIs or inline implementations
- Examples: View Transitions demos (11–14), Canvas 2D effects (15–20)

## Categories

| Category | IDs | Count |
|----------|-----|-------|
| `scroll` | 01–06, 36–40 | 11 |
| `3d` | 07–10, 21–22 | 6 |
| `transitions` | 11–14 | 4 |
| `css-canvas` | 15–20 | 6 |
| `pages` | 23–35, 41–48 | 21 |

## How the Gallery Hub Works

`index.html` is a single-page app with:
1. **Ambient canvas background** — Floating radial gradient particles with screen blend mode
2. **Registry loading** — Fetches `demos/registry.json` at startup (48 demos)
3. **Dynamic card rendering** — Creates `<a>` cards for each "ready" demo
4. **Category filtering** — Buttons filter by `scroll`, `3d`, `transitions`, `css-canvas`, `pages`
5. **Staggered entrance** — Cards fade in with position-based delay
6. **Claude badge** — Floating bottom-right badge with cycling AI attribution phrases
7. **Reduced motion** — Canvas hides, animations disable when `prefers-reduced-motion` is active

## Shared Utility Modules

### `shared/a11y.js`
- `prefersReducedMotion()` — Returns boolean, reactive to OS setting
- `setReducedMotion(bool)` — Programmatic toggle, fires CustomEvent
- `createMotionToggle(container)` — Renders toggle button widget

### `shared/demo-shell.js`
- `initDemoShell({ title, category, tech })` — Injects into any demo:
  - Back link to gallery (top-left, ESC key)
  - Motion toggle button (top-right)
  - Info bar with title + tags (bottom strip)

### `shared/colors.js`
- `palette` object — Canonical dark-theme color tokens

### `shared/motion-tokens.js`
- `durations` — 5 timing presets (fast→epic) in seconds
- `easings` — 6 GSAP ease strings
- `stagger` — 5 stagger config objects for `gsap.to()`

## Accessibility Approach

1. Every demo imports `prefersReducedMotion` from `shared/a11y.js`
2. On load, animations are disabled if the OS preference is set
3. The demo shell injects a toggle button for manual control
4. The toggle fires a `motion-preference` CustomEvent that demos listen for
5. `.reduced-motion` CSS class is toggled on `<html>` for CSS-based fallbacks
6. Decorative elements use `aria-hidden="true"`
7. Text maintains WCAG AAA contrast (17.4:1)

## Key Code Patterns

### GSAP + Lenis Smooth Scroll
```js
import gsap from 'gsap';
import ScrollTrigger from 'gsap/ScrollTrigger';
import Lenis from 'lenis';
gsap.registerPlugin(ScrollTrigger);
const lenis = new Lenis({ lerp: 0.1, smoothWheel: true });
lenis.on('scroll', ScrollTrigger.update);
gsap.ticker.add((time) => lenis.raf(time * 1000));
gsap.ticker.lagSmoothing(0);
```

### Three.js Scene with Bloom
```js
import * as THREE from 'three';
import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';

const composer = new EffectComposer(renderer);
composer.addPass(new RenderPass(scene, camera));
composer.addPass(new UnrealBloomPass(resolution, strength, radius, threshold));
```

### View Transitions Fallback
```js
const supportsVT = typeof document.startViewTransition === 'function';
if (supportsVT && !prefersReducedMotion()) {
  document.startViewTransition(() => updateDOM());
} else {
  updateDOM();
}
```

### Demo Shell Initialization
```js
import { initDemoShell } from '/shared/demo-shell.js';
import { prefersReducedMotion } from '/shared/a11y.js';
initDemoShell({ title: 'Demo Title', category: 'css-canvas', tech: ['tag1', 'tag2'] });

let reduced = prefersReducedMotion();
if (reduced) document.documentElement.classList.add('reduced-motion');

window.addEventListener('motion-preference', (e) => {
  reduced = e.detail.reduced;
  // Start or stop animations based on reduced state
});
```

### GSAP FLIP for Layout Transitions
```js
import gsap from 'gsap';
import Flip from 'gsap/Flip';
gsap.registerPlugin(Flip);

const state = Flip.getState(elements);
// ...change layout...
Flip.from(state, { duration: 0.6, ease: 'power2.inOut', stagger: 0.05 });
```

### ScrambleText Effect
```js
import gsap from 'gsap';
import ScrambleTextPlugin from 'gsap/ScrambleTextPlugin';
gsap.registerPlugin(ScrambleTextPlugin);

gsap.to(element, {
  duration: 1.5,
  scrambleText: { text: 'Final Text', chars: '01', speed: 0.4 }
});
```

### Scroll-Linked Counter (Demos 36, 41–48)
```js
const target = parseFloat(el.dataset.target);
ScrollTrigger.create({
  trigger: card,
  start: 'top 80%', end: 'top 20%',
  onUpdate: (self) => {
    const val = target * self.progress;
    el.textContent = Number.isInteger(target) ? Math.round(val) : val.toFixed(1);
  },
});
```

### CSS Hue Shift on Scroll (Demo 37)
```css
.gradient-text {
  background: linear-gradient(90deg,
    hsl(calc(var(--hue-hero) + 200), 80%, 55%),
    hsl(var(--hue-hero), 90%, 65%)
  );
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
}
```
```js
// GSAP drives the CSS variable on scroll
gsap.to(document.documentElement, {
  '--hue-hero': 360,
  ease: 'none',
  scrollTrigger: { start: 'top top', end: 'bottom bottom', scrub: 0.8 },
});
```

### SVG Path Drawing (Demo 40)
```js
const path = document.querySelector('.proc-line');
const length = path.getTotalLength();
gsap.set(path, { strokeDasharray: length, strokeDashoffset: length });
gsap.to(path, {
  strokeDashoffset: 0,
  ease: 'none',
  scrollTrigger: { trigger: section, start: 'top 70%', end: 'bottom 60%', scrub: 1.5 },
});
```

### Lenis Velocity Speed Lines (Demo 39, 47)
```js
let velocity = 0, smoothVelocity = 0;
lenis.on('scroll', (e) => { velocity = e.velocity; });

// In gsap.ticker:
smoothVelocity += (velocity - smoothVelocity) * 0.1;
velocity *= 0.92;
drawSpeedLines(smoothVelocity);  // Canvas 2D radial lines scaled to |velocity|
```

## Full-Page Design System Patterns (Demos 44–48)

Each full-page demo (44–48) uses a distinct design identity — not the shared dark navy default:

| Demo | Style | Fonts | Palette |
|------|-------|-------|---------|
| 44 — Fine Dining | Warm Editorial | Playfair Display + Cormorant Garamond + DM Sans | Cream `#f5f0e8`, terracotta, gold |
| 45 — Fitness Brand | Brutalist Bold | Barlow Condensed 900 | Pure black + `#f0e000` yellow |
| 46 — Real Estate | Light Minimal | Fraunces (italic display) + Inter | White, warm grays, charcoal |
| 47 — Music Platform | Neon Cyberpunk | Space Mono + Space Grotesk | `#080810` black, `#ff2d78` magenta, `#00e5ff` cyan |
| 48 — Photography | Dark Film | EB Garamond + Geist Mono | Deep black, warm off-white, `#c8a96e` gold |

### When building new full-page demos, choose a design DNA first:
1. Define palette with 5–7 custom properties
2. Choose primary display font (Google Fonts link in `<head>`)
3. Choose secondary body/UI font
4. Decide on light vs. dark mode
5. Set `--neon-glow` or `--shadow` tokens for the ambient feel
6. Only then write HTML structure and animations
